import numpy as np
import plotly.graph_objects as go
import streamlit as st

# --- 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô 3 ‡∏°‡∏¥‡∏ï‡∏¥ ---
# ‡πÉ‡∏ä‡πâ @st.cache_data ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ã‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
@st.cache_data
def calculate_E_field_3d(X, Y, Z, q, q_pos):
    """
    ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (Ex, Ey, Ez) ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏ô 3 ‡∏°‡∏¥‡∏ï‡∏¥
    ‡πÉ‡∏ä‡πâ‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏π‡∏•‡∏≠‡∏°‡∏ö‡πå (Coulomb's Law) ‡πÇ‡∏î‡∏¢‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏π‡∏•‡∏≠‡∏°‡∏ö‡πå (k) ‡πÄ‡∏õ‡πá‡∏ô 1
    
    ‡∏™‡∏π‡∏ï‡∏£: E = k * q / r^2 * rÃÇ  (k=1)
    """
    x0, y0, z0 = q_pos

    dx = X - x0
    dy = Y - y0
    dz = Z - z0

    r_squared = dx**2 + dy**2 + dz**2

    # ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏∏
    # ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤ r_squared ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ 0
    # ‡∏ó‡∏≥‡πÉ‡∏´‡πâ E ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡πÄ‡∏≠‡∏á)
    r_squared = np.where(r_squared < 1e-12, 1e-12, r_squared)
    r = np.sqrt(r_squared)

    # ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ E_magnitude = q / r^2 (k = 1)
    E_magnitude = q / r_squared

    # ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (Ex, Ey, Ez)
    # Ex = E_magnitude * (dx / r), Ey = E_magnitude * (dy / r), Ez = E_magnitude * (dz / r)
    Ex = E_magnitude * (dx / r)
    Ey = E_magnitude * (dy / r)
    Ez = E_magnitude * (dz / r)

    return Ex, Ey, Ez

# --- 2. Streamlit UI ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ---

st.set_page_config(page_title="3D Electric Field Visualizer (Plotly)", layout="wide")
st.title("üîå 3D Electric Field Visualization")
st.caption("‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ 3 ‡∏°‡∏¥‡∏ï‡∏¥‡∏£‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Plotly")

# --- 3. Sidebar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå ---

with st.sidebar:
    st.header("Charge Parameters")
    # ‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡πÉ‡∏´‡πâ‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ä‡∏ß‡∏•‡πÑ‡∏•‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ
    charge_q = st.slider("Charge Value (q)", -10.0, 10.0, 5.0, 0.5)
    
    st.subheader("Charge Position (x0, y0, z0)")
    lim_pos = 2.0
    charge_x0 = st.slider("x0", -lim_pos, lim_pos, 0.0, 0.1)
    charge_y0 = st.slider("y0", -lim_pos, lim_pos, 0.0, 0.1)
    charge_z0 = st.slider("z0", -lim_pos, lim_pos, 0.0, 0.1)
    
    charge_pos = (charge_x0, charge_y0, charge_z0)

    st.header("Grid Settings")
    n_points = st.slider("Resolution (Points per axis)", 5, 20, 10, 1)
    lim = st.slider("Boundary (-L to L)", 1.0, 5.0, 3.0, 0.5)
    
    cone_size_ref = st.slider("Vector Size Multiplier", 0.1, 2.0, 0.5, 0.1)
    
    # ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
    st.markdown("""
        ---
        **‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
        * **Charge Value (q):** ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏∏ (+ve = ‡∏™‡∏µ‡πÅ‡∏î‡∏á, -ve = ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)
        * **Resolution:** ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏Å‡∏ô
        * **Boundary:** ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        * **Vector Size Multiplier:** ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (E-field vectors)
        * **Color Scale (Hot):** ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ $|E|$ (‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏£‡∏á‡∏Å‡∏ß‡πà‡∏≤)
    """)

# --- 4. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü ---

# ‡πÉ‡∏ä‡πâ st.empty() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
# if st.button("Generate 3D Field") or True: # True: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ
# ‡πÉ‡∏ô Streamlit ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ô Sidebar ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
# ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç 'if st.button' ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÑ‡∏î‡πâ

# 4.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏¥‡∏î
x_range = np.linspace(-lim, lim, n_points)
y_range = np.linspace(-lim, lim, n_points)
z_range = np.linspace(-lim, lim, n_points)
X, Y, Z = np.meshgrid(x_range, y_range, z_range, indexing='ij')

# 4.2 ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
Ex, Ey, Ez = calculate_E_field_3d(X, Y, Z, charge_q, charge_pos)

# 4.3 ‡∏™‡∏£‡πâ‡∏≤‡∏á Trace ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏
charge_trace = go.Scatter3d(
    x=[charge_pos[0]], y=[charge_pos[1]], z=[charge_pos[2]],
    mode='markers',
    marker=dict(
        size=15,
        color='red' if charge_q >= 0 else 'blue',
        symbol='circle',
        opacity=1.0
    ),
    name=f'Point Charge q = {charge_q:.1f}'
)

# 4.4 ‡∏™‡∏£‡πâ‡∏≤‡∏á Cone trace ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
# ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î (Magnitude) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô colorscale
E_mag_flat = np.sqrt(Ex.flatten()**2 + Ey.flatten()**2 + Ez.flatten()**2)

# ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏™‡∏µ
max_e_mag = np.max(E_mag_flat)

field_trace = go.Cone(
    x=X.flatten(), y=Y.flatten(), z=Z.flatten(),
    u=Ex.flatten(), v=Ey.flatten(), w=Ez.flatten(),
    sizemode="absolute",
    sizeref=cone_size_ref,  # ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏ß‡∏¢
    anchor="tip", # ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏ß‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (X,Y,Z)
    colorscale='Hot',
    cmin=0,
    # ‡∏õ‡∏£‡∏±‡∏ö cmax ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏µ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô
    # ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ max_e_mag ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏°‡∏µ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°
    cmax=max_e_mag * 0.5 if max_e_mag > 0 else 1.0, 
    showscale=True,
    colorbar=dict(title='|E| Magnitude'),
    name='Electric Field Vector'
)

# 4.5 ‡∏à‡∏±‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü
fig = go.Figure(data=[charge_trace, field_trace])

fig.update_layout(
    title=f'3D Electric Field Visualization (q = {charge_q:.1f})',
    scene=dict(
        xaxis_title='X Axis',
        yaxis_title='Y Axis',
        zaxis_title='Z Axis',
        # ‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï
        aspectmode='cube',
        xaxis=dict(range=[-lim, lim]),
        yaxis=dict(range=[-lim, lim]),
        zaxis=dict(range=[-lim, lim])
    ),
    height=700,
    margin=dict(l=0, r=0, b=0, t=50)
)

# 4.6 ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô Streamlit
st.plotly_chart(fig, use_container_width=True)

# --- 5. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ï‡∏£ (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ---
st.subheader("üí° Physical Principle: Coulomb's Law")
st.markdown(
    """
    ‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ($\mathbf{E}$) ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏à‡∏∏‡∏î ($q$) ‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á $\mathbf{r}_0$ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏π‡∏•‡∏≠‡∏°‡∏ö‡πå (Coulomb's Law):
    """
)
st.latex(r'''
    \mathbf{E}(\mathbf{r}) = k \frac{q}{r^2} \hat{\mathbf{r}}
''')
st.markdown(
    """
    ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà:
    * $\mathbf{r}$ ‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
    * $\mathbf{r}_0$ ‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏∏
    * $r = |\mathbf{r} - \mathbf{r}_0|$ ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
    * $\hat{\mathbf{r}} = \frac{\mathbf{r} - \mathbf{r}_0}{r}$ ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏∏
    * $k$ ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏π‡∏•‡∏≠‡∏°‡∏ö‡πå (‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ $k=1$ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•)
    """
)
